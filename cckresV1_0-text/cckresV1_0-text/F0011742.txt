Naučite se sami Visual Basic 6

Pri izbiri katere od drugih možnosti za nove projekte ni nujno, da se tvori privzet obrazec, saj ga drugi tipi projektov morda ne potrebujejo. 
Obrazci so podrobno predstavljeni v razdelku "Delo z obrazci" v tem poglavju.

Izberite datoteko, ki jo želite uporabljati in kliknite gumb Open ali odprite datoteko z dvakratnim klikom. 
V nasprotju z običajnimi seznami datotek v Windows se teh datotek ne da razvrstiti po imenu ali mapah. 
Prikazane so v vrstnem redu, v katerem so bile nazadnje.

Registrirani datotečni tipi imajo več naprednih lastnosti. 
Določite lahko več kot eno operacijo nad tipi datotek. 
Projektna datoteka v Visual Basicu ima na primer tri različne operacije, ki jih določite ob registraciji: Open (Odpri), Make (Ustvari) in Run (Zaženi). 
Te lastnosti omogočajo, da ob vašem delu z datotekami prilagodite delovanje Windows. 
Za več informacij o Registry v Windows ter o registriranih datotečnih tipih preberite v Osbornovem priročniku Windows 98: The Complete Reference.

-- Pritisnite ALT-F4.

Tabela 1-1

Opomba

PRIMERI

Slika 1-8

2. 
Za prekinitev izbire kontrole kliknite gumb Pointer.

1. 
Izberite gumb Save Project v meniju File.

Dodajanje in odstranjevanje objektov v projektih

Večina aplikacij v okolju Windows, ki omogočajo tiskanje, obenem omogočajo tudi za določitev vrste tiskalnika, ki ga želimo uporabiti, ter možnost spremembe nastavitve tiskanja za ta tiskalnik. 
Tudi Visual Basic nudi vse te možnosti. 
Obstajata dva načina dostopa do nastavitve tiskalnika:

Izberite razdelek za pregledovanje kode zanj. 
Za pregledovanje kode za komandni gumb, ki se imenuje na primer cmdClickMe, izberete v polju Object. 
Prikazalo se bo okno Code in v njem koda za komandni gumb.

Kodne nastavitve in nastavitve oken na zavihku Editor v pogovornem oknu Options

List box lst lstPolicyCodes

Outline out outOrgChart

User-defined Type udt udtEmployee

S tem ste pridobili občutek za podatkovne tipe v Visual Basicu. 
V naslednjem razdelku tega poglavja so obravnavani deklariranje, uporaba spremenljivk, ter določitve podatkovnih tipov. 
Ko se odločate o podatkovnem tipu za spremenljivko, uporabite tabelo 2-3 kot referenco.

2. 
Ali je 55intSpeedLimit veljavno ime spremenljivke?

strDaysOfWeek(3) = “WED”

Vsak poskus klica procedure ali funkcije Private zunaj modula se konča z napako.

UPORABA PODPROGRAMOV

Katere vrste podatkov lahko vsebujeneka spremenljivka? 

1. 
Zaženite novo aplikacijo Standard EXE.

Alignment 2 – Center

End Sub

Left 120

Name cmdCancel

Izbirni gumbi so vzajemno izključujoči, kar pomeni, da so ob izbiri enega, drugi samodejno izključeni. 
Potrditvena polja niso vzajemno izključujoča, vendar jih je vseeno mogoče združiti v okvir. 
Pri tem lahko po želji izberete število potrditvenih polj. 

Za nastavitev vrednosti lastnosti več kontrol hkrati izberite vse kontrole, ki jih želite spremeniti, tako da pritisnete tipko SHIFT ter hkrati kliknete vsako od kontrol. 
Nato nastavite lastnosti v oknu Properties.

Width 3500

Top 1200

Slika 3-7

Lastnost Vrednost

3.3 UPORABA NAŠTEVNEGA POLJA IN KOMBINIRANEGA POLJA

Preprosta kombinirana polja zavzamejo enako veliko prostora kot navadno naštevno polje. 
Dejansko zavzamejo celo nekoliko več prostora, saj na vrhu vsebujejo tekstovno polje, v katerega lahko vnašate lastne vrednosti. 
Ta oblika kombiniranega polja se obnaša natanko tako kot spustni kombinirani seznam.

Private Sub cmdCopyItem_Click()

1. 
Katere parametre sprejme metoda AddItem?

Slika 3-13

UPORABA NAŠTEVNEGA SEZNAMA DATOTEK

1. 
Če želite uporabiti kontrolo DriveListBox, jo postavite na obrazec ter nastavite lastnosti za videz in položaj. 
Naštevni seznam pogonov samodejno prikaže vse črke pogonov.

4. 
Kako bi v naštevnem seznamu datotek prikazali le datoteke s končnico TXT?

3. 
Za izbrane kontrole izberite bodisi možnost Bring To Front bodisi možnost Send To Back.

RAVNANJE Z DOGODKI ZA KONTROLNA POLJA

PRIMERI

4.2 Pretvarjanje nizov

1. 
Kakšen podatkovni tip predstavlja lastnost Text tekstovnega polja?

Brez teh narekovajev stavek sicer ne bi povzročil napake, vendar pa ne bi deloval. 
Treba si je namreč zapomniti, da v primeru, ko se stavek Option Explicit v deklaracijskem razdelku modula ne pojavi, spremenljivke ni potrebno deklarirati. 
To pa pomeni, da Visual Basic oznake AZ (brez narekovajev) ne bi interpretiral kot spremenljivko in napake ne bi povzročil. 
Vrednost strState bi bila dodeljena vrednosti spremenljivke AZ, ki pa vrednosti nima - NULL.

Če funkciji Asc ne podamo nobenega znaka, pride do napake med izvajanjem.

S to kodo postavite v spremenljivko strChar veliko črko Z.

PRIMERI

Empty prazen niz ("")

Spremenljivka strExample ima zdajvrednost "The answer is 245".

Operator & je v kodni vrstici mogoče uporabiti, kolikokrat želite. 
Uporabimo ga lahko poljubno mnogokrat. 
V primeru, ko imate štiri spremenljivke, ki bi jih radi združili v niz, storite to v eni sami kodni vrstici z uporabo treh operatorjev &.

"10" + 10

Funkcija UCase pretvori niz v velike črke. 
Ta funkcija prejme argument niz ter vrne vrednost niz. 
Za pretvorbo niza v velike črke sledite naslednjemu primeru:

vbProperCase 3 pretvori prvo črko vsake besede v veliko črko, začetnico, ostale so male črke

Tabela 4-2 

Izraz je zahtevani argument, ki je lahko katerikoli datum, čas, številka ali niz. 
Format je izbirni argument, ki določa njegov način formatiranja. 
Poznamo še dva druga izbirna argumenta (firstdayofweek, firstweekofyear), ki pa ju na tem mestu ne obravnavamo.

Za dodajanje večjega števila presledkov nizu ali mnogokratne ponovitve nekega znaka uporabite funkciji Space in String. 
Funkcija Space sprejme numerični argument in vrne vrednost niz s številom presledkov, določenih v argumentu. 
Sledi primer, v katerem je postavljena spremenljivka strSpacedOut na 20 presledkov:

1. 
Naslednja kodna vrstica intStringLenght priredi vrednost 9:

strTrimmed = Trim(" Trim Me ")

InStr("Send one copy of your final copy to us.", "copy")

UPORABA FUNKCIJE STRCOMP

Obnašanje operatorja Like je odvisno od stavka Option Compare.

1. 
Deklarirajte niz s fiksno dolžino v velikosti petih znakov!

4. 
Katero funkcijo bi uporabili, da bi spremenili vse začetnice besed v velike črke?

DEKLARACIJA ŠTEVILSKIH SPREMENLJIVK

Pri delu z Visual Basicom boste v glavnem uporabljali desetiški številski sistem. 
Tak sistem uporabljajo ljudje vsakodnevno in za delo z njim v Visual Basicu ne potrebujete kakšnega posebnega usposabljanja. 
V Visual Basicu se lahko uporabljajo tudi drugi številski sistemi. 
Čeprav se uporabljajo redko, so predstavljeni v tem razdelku. 
Ponavadi se v Visual Basicu uporabljajo trije številski sistemi:

Sgr(number)

UPORABA TRIGONOMETRIČNIH FUNKCIJ

4. 
Naslednji primer vrne vrednost 0:

Čeprav funkcija Rnd generira le števila med 0 in 1, lahko kljub temu dobimo večja naključna števila. 
Naslednja formula producira naključna cela števila med 1 in 10: Int(10 Rnd + 1).

3. 
Naslednja koda inicializira generator naključnih števil s semenom 1:

6.4 Uporaba stavka For

PREGLED PRIDOBLJENIH SPRETNOSTI

3. 
Katera funkcija vrne absolutno vrednost števila?

Opomba

blnCorrectPassword = True

If txtPassword.
Text = "secret" Then

IIf(condition, TrueValue, FalseValue)

Drugi in tretji primer bi lahko bila tudi 1 To 5 in 1 To 10. 
Ker pa stavek Select Case uporabi prvi primer, ki ustreza primerjavi, takšen način pisanja obsega vrednosti naredi kodo bolj pregledno. 

Case "England", "France", "Germany"

Line Input #intFileNumber, strText

Vprašanja zbirajo uporabnikove podatke

Pri uporabi te kode morate paziti, da deklarirate vntAnswer kot Variant. 
Rezultata metod sta enaka, le da pri slednji ni potrebno klicati funkcij LBound in UBound. 

1. 
Naslednja funkcija uporablja stavek For za potenciranje števila:

Next intCounter

Dim intCounter As Integer

intCounter = intCounter + 1

7.2 Uporaba funkcije InputBox

7.4 Uporaba pogovornih oken Open in Save As kontrole CommonDialog

Slika 7-2

UPORABA FUNKCIJE MSGBOX ZA PRIKAZOVANJE PODATKOV

Vrstice v sporočilu pogovornega okna ločite z znakom za prehod v novo vrsto Chr(13) in z znakom za konec vrstice Chr(10). 

Dim Result As vbMsgBoxResult

1. 
Ustvarite preprosto pogovorno okno, ki izpiše sporočilo, in gumb OK z uporabo funkcije MsgBox. 
Naslednja koda vas obvesti, da je prenos datoteke končan. 
Pogovorno okno kaže slika 7-4:

1. 
Kontrolo CommonDialog dodate projektu, tako da odprete pogovorno okno Components in izberete kontrolo s seznama. 

Dim dblTaskID As Double

– Podatkovna baza Access (*.mdb)

Število lastnosti, ki vplivajo na pogovorno okno Color, je omejeno. 
Kontrola dejansko prikaže samo lastnosti Color, Flags in CancelError tega pogovornega okna. 
Odprite stran lastnosti CommonDialog z dvakratnim klikom lastnosti Custom. 
Nato kliknite zavihek Color, da se pokažejo lastnosti pogovornega okna Color, kot kaže slika 7-13. 

Slika 7-11

Iz palete pogovornega okna Color izberete barvo

Loop While dlgColor.
Color = vbBlack Or dlgColor.
Color = vbWhite

Tabela 7-7

Objekti nabora znakov se ustvarijo z objektom StdFont. 
Pri deklaraciji objekta nabora znakov je treba uporabiti ključno besedo New. 
Pred prirejanjem objekta lastnosti nabora znakov morate nastaviti ključno besedo Set. 

f.
Name = dlgFont.FontName

2. 
Napišite kodni blok, ki odpre pogovorno okno Print, ki privzeto izpisuje eno kopijo, lahko tiska v obsegu od 5 do 25 in ne vpliva na privzeti tiskalnik. 

Konstanta Vrednost Opis

4. 
Kliknite gumb Insert. 
S tem vrinete menijsko postavko pred trenutno izbrano, kot kaže slika 8-5. 

Izberite menijsko postavko za presledkom, kjer želite vstaviti novo menijsko postavko

Dodajanje kode ukazu menija je preprosto. 
V oknu Form izberite ukaz menija. 
Pri tem se odpre Code Editor in definira proceduro dogodka (event procedure) Click za ta ukaz menija. 
Iz podmenija Text Color izberite ukaz Black. 

mnuEditTextColorRed.Checked = True

'Verify that text is selected

'Place selected text on clipboard

Private Sub mnuEditSelectAll_Clikc()

Private Sub mnuEdit_Click()

mnuItem.Checked = Not (mnuItem.Checked)

UPORABA METODE POPUPMENU

Uporaba tiskalnega sistema v okolju Windows prinaša več prednosti, od katerih je največja ta, da je celotna koda za dostop in upravljanje s tiskalniki že napisana in preizkušena. 
Tako lahko uporabite nabor ukazov, ki se nanašajo na tiskalnike in prepustite tiskalnemu sistemu v Windows okolju, da posameznemu tiskalniku pošlje ustrezne ukaze. 

End Sub

DeviceName Ime naprave za tiskanje

Lastnosti objekta Printer 

2. 
Spremenite lastnosti objekta Printer, tako da se privzeti tiskalnik vedno ujema s tistim v Windowsih. 

Aspect Izbirni argument, ki določa razmerje osi kroga (privzeta vrednost 1.0 pomeni popoln krog)

Besedilo se na risalno območje objekta Printer postavlja z metodo Print. 
Vsak stavek metode Print se začne v novi vrstici. 
Večvrstično besedilo v okviru metode Print dobimo z uporabo znaka za konec vrstice in prehod v novo (carriage return Chr(13)). 
Sintaksa metode Print je naslednja :

4. 
Ustvarite podprogram, ki natisne vrsto in ime kontrole za vse kontrole na obrazcu, vsako na svojo stran.

10.2 Branje in pisanje v datoteke

Pred pričetkom tega poglavja je dobro, da znate odgovoriti na naslednja vprašanja:

Če uporabite zvezdico (wildcard) v argumentu Filespec, lahko naenkrat pobrišete več datotek. 
Argument Force je izbiren. 
Ob vrednosti True argumenta Force se izbrišejo vse datoteke, ki ustrezajo specifikaciji v Filespec, četudi so namenjene samo branju (read-only). 
Če je argument Force False ali je izpuščen, potem se read-only datoteke ne izbrišejo.

Set fso = CreateObject("Scripting.FilesystemObject")

Dim fso As Object

Pri premikanju po datoteki z objektom TextStream se uporablja datotečni kazalec, ki prikazujetrenutni položaj v datoteki. 
Objekt TextStream ima več lastnosti, ki opisujejo lokacijo kazalca in s tem olajšajo obdelavo vsebine datoteke. 
V tabeli 10-2 so opisane lastnosti metode, ki jih mogoče le brati.

ts.
WriteLine ("End Of File")

strFiles(3) = "03FILE.
TXT"

ts.
Close

Orodjarna ob zagonu ne vsebuje ADO Data Control, zato jo morate dodati vsakemu projektu, ki to komponento uporablja. 
ADO Data Control dodate projektu, tako da odprete pogovorno okno Components in izberete Microsoft ADO Data Control (OLEDB), kot prikazujeslika 10-1. 

Kliknite zavihek Authentication, če dostop do podatkovne baze zahteva uporabniško ime in geslo. 
Slika 10-4 prikazuje stran Authetication.

Slika 10-13

Kliknite kontrolo DataGrid z desnim miškinim gumbom in iz bližnjičnega menija izberite polja Retrieve. 
Pri tem se pojavi vprašanje, če želite zamenjati obstoječo razporeditev rešetke. 

Ustvarjanje obrazca Master/Detail

Slika10-28

RAZUMEVANJE TCP

Nastavitev TCP odjemalca

Pošiljanje podatkov med TCP strežniki in odjemalci

udpPeer2.RemoteHost = "ctx"

Private Sub txtSendData_Change()

1. 
Naslednja koda procedure dogodka Click izpolni kontrolo Text Box s HTML kodo Microsoftove domače strani na svetovnem spletu. 

1. 
Ustvarite obrazec, ki omogoči, da odprete vnesen URL in ga prikažete v tekstovnem polju.

MsgNoteText Vsebina sporočila

2. 
Katera metoda se uporablja za dostop do podatkov na spletnem strežniku ali strežniku FTP?

End Function

Slika 12-3 

Opomba

IZSTOP IZ KODE

Pri premikanju po kodi se lahko znajdete v podprogramu, ki vas ne zanima več. 
Recimo, da ste že pregledali, kar ste želeli, ali ste vstopili v podprogram po naključju. 
Če želite program ponovno pognati, kliknite gumb Run. 
Če pa želite samo izstopiti iz trenutnega podprograma, kliknite gumb Step Out. 

VAJE

? intNumber

Debug.
Print output

Dim i As Long

Next

1. 
Funkciji GetChar dodajte kodo, ki izpiše besedilo, iz katerega je vzet znak, njegov položaj in vrnjen znak. 

2. 
Kako bi izvedli vrstico kode brez klicev podprogramov iz te vrstice?

Preprosta različica stavka On Error povzroči, da se po napaki izvrši vrstica, ki sledi tej, ki je napako sprožila. 
Ta stavek je uporaben, kadar zajete napake posebne kode za ravnanje z njimi ne zahtevajo in tok programa ni moten. 
Sintaksa te variacije stavka On Error je:

On Error Resume Next

Stavek On Error s sintakso: On Error GoTo 0 prepreči ravnanje ob napakah v podprogramu. 

Exit Sub

2. 
Dodajte del kode za ravnanje z napakami podprogramu, ki nadaljuje z izvajanjem v vrstici, ki sledi tisti, ki je napako sprožila. 

Objekt Err ima številne lastnosti, ki ob pojavu napake privzamejo določene vrednosti. 
Lastnosti se lahko uporabijo za določitev najboljšega načina za ravnanje z različnimi napakami. 
Naslednji razdelek opisuje najbolj pogosto uporabljane lastnosti objekta Err. 

V določenih situacijah je treba napako namerno ustvariti. 
To storite z metodo Raise objekta Err. 
Klic te metode sproži napako ob izvajanju podprograma. 
Naslednja razdelka vsebujeta podrobnosti o metodah Raise in Clear objekta Err. 

3. 
Naslednji stavek povzroči napako v aplikaciji:

3. 
Napišite stavek, ki povzroči napako "File Not Found".

1.2 VAJE

4. 
Desnokliknite orodjarno in iz bližnjičnega menija izberite Add Tab. Vpišite Internet v pogovorno okno New Tab Name in kliknite gumb OK. 

– FillColor

POGLAVJE 2

7. 
Ne, projekti se prevedejo glede na nastavitve v Make in Compile zavihkih pogovornega okna Project Properties. 

1. 
Da se kontrola Label samodejno prilagodi velikosti prikazanega besedila, postavite lastnosti AutoSize na True. 

1. 
Polje kontrol lahko vsebuje samo eno vrsto kontrol. 

strLicenseNumber = txtLicenseNumber.
Text

3. 
Naslednji stavek spremenljivki dblLogValue priredi vrednost logaritma 2.7:

y = 2

z = 3

Case n To z

Int(strScore)

4. 
Naslednja koda ustvari enak rezultat kot četrti primer v tem razdelku. 
Pri tem namesto stavka If uporabi stavek Select:

Case vb Cancel

strMessage = "Enter second number (must be valid number)."

dlgFont.ShowFont

– Retry

2. 
Naslednja koda povzroči, da dogodek Click mnEdit naredi podmeni TextColor neviden, če ForeColor tekstovnega polja ni črna ali rdeča:

End Sub

Shift As Integer, X As Single, Y As Single)

1. 
Drugi tiskalnik v zbirki Printers naslovimo na naslednji način:

Printer.
Line(0, 500) - (1000 , 500)

tcpClient.Connect

mpmMessage.ReciAddress = txtReciAddress.
Text

PREVERJANJE PRIDOBLJENIH SPRETNOSTI

Debug.
Print intLocation

Loop Until intSum = 100

1. 
Koda za to vajo je naslednja :

American National Standard Institute je organizacija, ki določa specifikacije za komunikacijo in 

ASINHRONO

Datoteka tipa bitmap (bitna slika) vsebuje vse potrebne podakte za prikaz slike na računalniku z Windows.

Glej izvorna koda.

DATA AČEŠ OBJECT (DAO)

Med načrtovalnim časom se spreminja in ustavrja aplikacija, ki se nanaša tudi na čas, ko se aplikacije ne izvaja.

DOGODKOVNI PODPROGRAMI

HTML

Subrutine so deli kode, ki izvajajo določena opravila. 

Transmišion Control Protocol/Internet Protocol (TCP/IP) je standard, ki se uporablja za komunikacijo med računalniki. 
V velikem številu omrežij, kot tudi internetu, je TCP/IP glavni komunikacijski protokol. 

TWIP

Assert metoda, 350-352 

Auto Quick Info opcija, okno Code, 53 

Autosize, 80 

RGB barva in, 211, 214-215

naštevno polje pogonov, 106-107

naštevna polja, 98-103

date, 66, 69

spremenljivke in, 63-64

Err.Description, 362-363 

uporaba metod objekta Err, 363-366

ravnanje za polja kontrol, 115-116

FileSystemObject, 272

branje (metoda SkipLine), 279

uporaba lastnosti objekta TextStream, 280-283

uporaba z zbirko Printers, 258

obrazci, 15-20 dodajanje ADO Data Control k, 285-288

Integer podatkovni tip, 68 

funkcija Int, 160

za spremenljivke, 56, 59

števila, 147-165 uporaba matematičnih funkcij, 159-162

odpiranje datotek v, 13-14

pogovornega okna Open, 209

kontrol TextBox, 84-85

Raise metoda, 364 

Right funkcija, 139-141 

StrConv function, 134-135 

stavek Option Compare, 143

nizi, manipulacija funkcije Left, Right in Mid, 139-141

uporabnikovi dokumenti (.dob), 10-11 

uporaba dosega, 70-73

